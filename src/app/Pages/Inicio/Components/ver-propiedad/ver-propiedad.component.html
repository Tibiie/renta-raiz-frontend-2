<app-navbar [alwaysScrolled]="true"></app-navbar>

<div class="flex flex-col">
    <div *ngIf="propiedad?.images?.length > 0" class="w-full flex flex-col items-start ml-40">
        <!-- Carrusel principal -->
        <div id="carousel" class="w-full max-w-3xl relative" data-carousel="static">
            <div class="relative h-[450px] overflow-hidden rounded-xl">
                <div *ngFor="let img of propiedad.images; let i = index"
                    [ngClass]="{ 'hidden': selectedIndex !== i, 'block': selectedIndex === i }"
                    class="duration-700 ease-in-out" data-carousel-item>
                    <img [src]="img.imageurl" alt="Imagen propiedad"
                        class="absolute w-full h-full object-cover rounded-xl" />
                </div>
            </div>

            <!-- Controles -->
            <button type="button"
                class="absolute top-0 left-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
                (click)="prevImage()">
                <span
                    class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50">
                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                </span>
            </button>
            <button type="button"
                class="absolute top-0 right-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
                (click)="nextImage()">
                <span
                    class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/30 group-hover:bg-white/50">
                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                    </svg>
                </span>
            </button>
        </div>

        <!-- Miniaturas -->
        <div class="w-full max-w-3xl flex mt-4 gap-3 justify-center">
            <ng-container *ngFor="let img of propiedad.images.slice(0, 3); let i = index">
                <div class="relative w-1/3 h-32 rounded-md overflow-hidden cursor-pointer group"
                    (click)="selectImage(i)">
                    <img [src]="img.imageurl" [alt]="'Miniatura ' + (i + 1)"
                        class="w-full h-full object-cover transition duration-300 border-2"
                        [class.border-blue-500]="selectedIndex === i" />

                    <!-- Superposición para mostrar más imágenes -->
                    <div *ngIf="i === 2 && propiedad.images.length > 3"
                        class="absolute inset-0 bg-[#001b3c]/80 flex items-center justify-center text-white text-lg font-semibold rounded-md">
                        +{{ propiedad.images.length - 3 }}
                    </div>
                </div>
            </ng-container>
        </div>
    </div>
</div>